import base64

exec(base64.b64decode('IyEvdXNyL2Jpbi9weXRob24KCmltcG9ydCBzb2NrZXQKaW1wb3J0IHJlCmltcG9ydCBvcwoKdHJ5OgogICAgaW1wb3J0IHJlcXVlc3RzCmV4Y2VwdDoKICAgICAgICBwcmludCgiSW5zdGFsYXJlbW9zIHBhcmEgdm9jZSIpCiAgICAgICAgb3Muc3lzdGVtKCJwaXAgaW5zdGFsbCByZXF1ZXN0cyIpCiAgICAgICAgZXhpdCgpCgoKb3Muc3lzdGVtKCJjbGVhcnx8Y2xlYXIiKQoKCgoKcHJpbnQgKCIiIgo9PT09PT09PT09PT09PT09PT09PT09PQo9ICAgIFRTQ0FOIFYuIDAuNiAgICAgPQo9PT09PT09PT09PT09PT09PT09PT09PQoKIz4gUm9ib3RzL1NpdGVtYXAuCiM+IFZ1bG5zIFNxbEluamVjdGlvbiBHRVQvUE9TVC4KIz4gUHJvdWN1cmEgZGUgYXJxdWl2b3MgbWFsaWNpb3NvcyAoU0hFTEwpLgojPiBTY2FubmVyIFdQL0pvb21sYS4KIz4gQWRtaW4gRmluZGVyLgojPiBTcWxpQnlwYXNzIFRlc3QgKERlc2Vudm9sdmltZW50by4uLikKCiM+IE9CUzogVU0gU0NBTiBDT01QTEVUTyBQT0RFIERVUkFSIDIwIE1JTlVUT1MsIFBPSVMgVEVNT1MgTUFJUyBERSAxMC4wMDAgRElSRVRPUklPUyBQQVJBIFRFU1RFLgojPiBFTSBCUkVWRSBNQUlTIFZFTE9DSURBREUgTk8gU0NBTi4KIiIiKQoKcHJpbnQoIkNvbG9xdWUgYSBiYXJyYSBsb2dvIGFvIGZpbmFsIGRvIHNpdGUgKHd3dy5zaXRlLmNvbS8pIikKc2l0ZXQgPSByYXdfaW5wdXQoIkRpZ2l0ZSBvIHNpdGUgcXVlIHNlcmEgdmVyaWZpY2FkbzogIikKIAogICAgICAKcHJpbnQgKCI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iKQoKcHJpbnQoIlByb2N1cmFuZG8gcm9ib3RzLnR4dC9zaXRlbWFwLnhtbC4uLiIpCnByaW50KCIgIikKcm9ib3QgPSBvcGVuKCdyb2JvdC93b3JkbGlzdC50eHQnKS5yZWFkbGluZXMoKQpmb3IgbGluaGFyb2JvdCBpbiByb2JvdDoKICAgICAgICByZXNwb3N0YXJvYm90ID0gcmVxdWVzdHMuZ2V0KHNpdGV0K2xpbmhhcm9ib3QpCiAgICAgICAgY29kaWdvcm9ib3QgPSByZXNwb3N0YXJvYm90LnN0YXR1c19jb2RlCiAgICAgICAgaWYgY29kaWdvcm9ib3QgPT0gMjAwOgogICAgICAgICAgIHByaW50IHNpdGV0K2xpbmhhcm9ib3QKICAgICAgICAgICBzdiA9IG9wZW4oJ3JvYm90L3N1YnMudHh0JywnYScpCiAgICAgICAgICAgc3Yud3JpdGUoc2l0ZXQrbGluaGFyb2JvdCkKICAgICAgICAgICBzdi5jbG9zZSgpCnByaW50ICgiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IikKcHJpbnQgKCJCdXNjYW5kbyB1cmxzIGNvbSBwYXJhbWVudHJvcyBpZD0iKQoKYXJxdWl2b3NxbGkgPSBvcGVuKCdzcWxpL3dvcmRsaXN0LnR4dCcsJ3InKS5yZWFkbGluZXMoKQpmb3IgbGluaGFTcWxpIGluIGFycXVpdm9zcWxpOgogICAgcmV0b3Jub1NxbGkgPSByZXF1ZXN0cy5nZXQoc2l0ZXQrbGluaGFTcWxpKS5zdGF0dXNfY29kZQogICAgcmVzcG9zdGFTcWxpID0gcmVxdWVzdHMuZ2V0KHNpdGV0K2xpbmhhU3FsaSsiJyIpLnRleHQKICAgIGlmIHJldG9ybm9TcWxpID09IDIwMDoKICAgICAgIGlmICdteXNxbF9mZXRjaF9hcnJheSgpJyBpbiByZXNwb3N0YVNxbGkgb3IgJ1lvdSBoYXZlIGFuIGVycm9yIGluIHlvdXIgU1FMIHN5bnRheCcgaW4gcmVzcG9zdGFTcWxpIG9yICdhcmd1bWVudCBpcyBub3QgYSB2YWxpZCcgaW4gcmVzcG9zdGFTcWxpIG9yICdGYXRhbCBlcnJvcicgaW4gcmVzcG9zdGFTcWxpOgogICAgICAgICAgIHByaW50KCJVcmwgVnVsbjogIitzaXRldCtsaW5oYVNxbGkpCiAgICAgICAgICAgc3ZhID0gb3BlbiAoJ3NxbGkvdnVsbi50eHQnLCdhJykKICAgICAgICAgICBzdmEud3JpdGUoc2l0ZXQrbGluaGFTcWxpKQogICAgICAgICAgIHN2YS5jbG9zZSgpIAoKcHJpbnQgKCI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iKQpwcmludCAoIiAiKQpwcmludCAoIkJ1c2NhbmRvIGZhbGhhcyBkZSBTcWxpIFBvc3QiKQphcnF1aXZvcG9zdCA9IG9wZW4oJ3NxbGkvd29yZGxpc3RwLnR4dCcsJ3InKS5yZWFkbGluZXMoKQpmb3IgbGluaGFQb3N0IGluIGFycXVpdm9wb3N0OgogICAgcmV0b3Jub1Bvc3QgPSByZXF1ZXN0cy5nZXQoc2l0ZXQrbGluaGFQb3N0KS5zdGF0dXNfY29kZQogICAgcmVzcG9zdGFQb3N0ID0gcmVxdWVzdHMuZ2V0KHNpdGV0K2xpbmhhUG9zdCkudGV4dAogICAgaWYgcmV0b3Jub1Bvc3QgPT0gMjAwOgogICAgICAgaWYgJ215c3FsX2ZldGNoX2FycmF5KCknIGluIHJlc3Bvc3RhUG9zdCBvciAnWW91IGhhdmUgYW4gZXJyb3IgaW4geW91ciBTUUwgc3ludGF4JyBpbiByZXNwb3N0YVBvc3Qgb3IgJ0ZhdGFsIEVycm9yJyBpbiByZXNwb3N0YVBvc3Q6CiAgICAgICAgICAgcHJpbnQoIlVybCBWdWxuOiAiK3NpdGV0K2xpbmhhUG9zdCkKICAgICAgICAgICBzdmUgPSBvcGVuICgnc3FsaS92dWxucG9zdC50eHQnLCdhJykKICAgICAgICAgICBzdmUud3JpdGUoc2l0ZXQrbGluaGFQb3N0KQogICAgICAgICAgIHN2ZS5jbG9zZSgpIApwcmludCAoIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSIpCgoKcHJpbnQgKCJWYW1vcyBhY2hhciBQbHVnaW5zIGluc3RhbGFkb3MgV29yZHByZXNzL0pvb21sYS4uLiAiKQpwcmludCgiVGVzdGFkbyBXb3JkcHJlc3MuLi4iKQphcnF1aXZvd3AgPSBvcGVuKCdwbHVnaW5zL3dvcmRwcmVzcy93b3JkcHJlc3MudHh0JywncicpCmxpbmhhc3dwID0gYXJxdWl2b3dwLnJlYWRsaW5lcygpCmZvciBsaW5oYXdwIGluIGxpbmhhc3dwOgogICAgICAgIHJlc3Bvc3Rhd3AgPSByZXF1ZXN0cy5nZXQoc2l0ZXQrbGluaGF3cCkKICAgICAgICBjb2RpZ293cCA9IHJlc3Bvc3Rhd3Auc3RhdHVzX2NvZGUKICAgICAgICBpZiBjb2RpZ293cCA9PSAyMDA6CiAgICAgICAgICAgIHN2ID0gb3BlbigncGx1Z2lucy93b3JkcHJlc3Mvb3V0cHV0LnR4dCcsJ2EnKQogICAgICAgICAgICBzdi53cml0ZShzaXRldCtsaW5oYXdwKQogICAgICAgICAgICBwcmludCAoc2l0ZXQrbGluaGF3cCkKCnByaW50ICgiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IikgICAgICAgCnByaW50KCJCdXNjYW5kbyBzaGVsbCB1cGFkYSBuZXNzZSBzaXRlLi4uIikKcHJpbnQoIiAiKQpwcmludCgiSXNzbyBwb2RlIGRlbW9yYXIgdW5zIDIgYSA0IG1pbnV0b3MiKQphcnF1aXZvc2hlbCA9IG9wZW4oJ3NoZWxsL3dvcmRsaXN0LnR4dCcsJ3InKQpsaW5oYXNzaGVsPSBhcnF1aXZvc2hlbC5yZWFkbGluZXMoKQpmb3IgbGluaGFzaGVsIGluIGxpbmhhc3NoZWw6CiAgICAgICAgcmVzcG9zdGFzaGVsID0gcmVxdWVzdHMuZ2V0KHNpdGV0K2xpbmhhc2hlbCkKICAgICAgICBjb2RpZ29zaGVsID0gcmVzcG9zdGFzaGVsLnN0YXR1c19jb2RlCiAgICAgICAgaWYgY29kaWdvc2hlbCA9PSAyMDA6CiAgICAgICAgICAgc3ZpID0gb3Blbignc2hlbGwvc2hlbGwudHh0JywnYScpCiAgICAgICAgICAgcHJpbnQgc2l0ZXQrbGluaGFzaGVsCnByaW50ICgiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IikKcHJpbnQgKCIgIikKCnByaW50ICgiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IikKcHJpbnQgKCJWYW1vcyBhY2hhciBvIHBhaW5lbCBhZG1pbmlzdHJhZG9yLi4uICIpCnByaW50KCJWZXJpZmljYW5kbyA1LjUwMCBkaXJldG9yaW9zIGlzc28gcG9kZSBkZW1vcmFyLi4uIEFndWFyZGUuIikKYXJxdWl2byA9IG9wZW4oJ2Rpci93b3JkbGlzdC50eHQnLCdyJykKbGluaGFzID0gYXJxdWl2by5yZWFkbGluZXMoKQpmb3IgbGluaGEgaW4gbGluaGFzOgogICAgICAgIHJlc3Bvc3RhID0gcmVxdWVzdHMuZ2V0KHNpdGV0K2xpbmhhKQogICAgICAgIGNvZGlnbyA9IHJlc3Bvc3RhLnN0YXR1c19jb2RlCiAgICAgICAgaWYgY29kaWdvID09IDIwMDoKICAgICAgICAgICAgc3YgPSBvcGVuKCdkaXIvcGFpbmVsLnR4dCcsJ2EnKQogICAgICAgICAgICBzdi53cml0ZShzaXRldCtsaW5oYSkKICAgICAgICAgICAgcHJpbnQgKHNpdGV0K2xpbmhhKQogICAgICAgCnByaW50KCIgIikKcHJpbnQgKCI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iKQpwcmludCAoIkNhc28gbmFvIHRlbmhhIGFwYXJlY2lkbyBuZW5odW0gbGluayBhY2ltYSBwb3NzYSBzZXIgcXVlIG5hbyBoYSBwYWluZWwgZGUgYWRtLiIpCnByaW50ICgiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IikKCiMjcHJpbnQoIiAiKQojcHJpbnQgKCJPIG5vc3NvIFNDQU4gYWNob3UgbyBwYWluZWwgY29ycmV0byBwYXJhIG8gcGFpbmVsIGFkbWluaXN0cmF0aXZvPyBTZSBzaW0gW1NdLCBzZSBuYW9bTl0iKQojc24gPSBpbnB1dCgiIz4iKQojaWYgc24gPT0gUyBvciBzOgojICAgIHByaW50ICgiTGVnYWwsIHZhbW9zIGZhemVyIHRlc3RlIGRlIFNxbGlCeXBhc3MgbmVzc2UgcGFpbmVsLi4uIikKIyAgICBhcnF1aXZvYnlwYXNzID0gb3BlbignZGlyL3BhaW5lbC50eHQnLCAnYScpCiMgICAgbGluaGFzCgogICAgICAgCnByaW50KCJGSU0hIFRPRE9TIE9TIFJFTEFUT1JJT1MgVk9DRSBQT0RFIEVOQ09OVFJBUiBOTyBBUlFVSVZPIENIQU1BRE8gKG91dHB1dC50eHQpIikK'))
